# DNS-клиент

Представляет собой программу, выполняющая роль DNS-клиента.

## Запуск программы
```
./gradlew build
java -jar DNS-client-1.0-SNAPSHOT [-a inetAddress] [-p port]
```
### Аргументы командной строки
- \[-a inetAddress] - адрес, на котором находится DNS-сервер. Необязательный, по умолчанию 10.0.0.1;
- \[-p port] - порт, на котором будет запущен сервер. Необязательный, по умолчанию равен 53.

# DNS

## Формат пакета

    +---------------------+
    |        Header       |
    +---------------------+
    |       Question      | the question for the name server
    +---------------------+
    |        Answer       | RRs answering the question
    +---------------------+
    |      Authority      | RRs pointing toward an authority
    +---------------------+
    |      Additional     | RRs holding additional information
    +---------------------+

## Header

Заголовок пакета. Присутствует всегда. Имеет следующий формат:

                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      ID                       |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |QR|   Opcode  |AA|TC|RD|RA|   Z    |   RCODE   |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    QDCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ANCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    NSCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ARCOUNT                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

### ID
Размер 16 бит. 
Идентификатор запроса. 
Генерируется клиентом.
Необходим для сопоставления ответов на запросы.

### QR
Размер 1 бит. Указывает, запрос (0) это или ответ (1).

### Opcode

Размер 4 бита. Указывает на тип запроса из приведённых ниже:

- 0 - стандартный запрос (QUERY),
- 1 - инверсивный запрос (IQUERY),
- 2 - запрос состояния сервера (STATUS),
- 3-15 - зарезервировано.

### Флаги AA, TC, RD, RA

Размер 1 бит.

- AA - Authoritative Answer;
- TC - TrunCation. Указывает, что сообщение было усечено;
- RD - Recursion Desired. Указывает серверу, что необходимо рекурсивно выполнять запрос; 
- RA - Recursion Available. Указывает в ответе, что доступна поддержка рекурсивных запросов на сервере.

### Z
Размер 3 бита. Зарезервировано. Должен быть 0.

### RCODE
Размер 4 бита. Указывает на код ответа из приведённых ниже:

- 0 - ошибок нет;
- 1 - Ошибка формата. Сервер не смог интерпретировать запрос;
- 2 - Ошибка сервера. Сервер не смог обработать запрос из-за проблем;
- 3 - Ошибка имени. Доменное имя, указанное в запросе, не существует;
- 4 - Не реализовано. Указывает, что сервер не поддерживает запрошенный тип запроса;
- 5 - Отказано. Сервер отказывается выполнить указанную операцию по соображениям политики.

### QDCOUNT 
Размер 16 бит.
Целое число без знака, определяющее количество записей в разделе запроса.

### ANCOUNT 
Размер 16 бит.
Целое число без знака, определяющее количество записей в разделе ответа.

### NSCOUNT
Размер 16 бит.
Целое число без знака, определяющее количество записей в разделе авторитетных записей.

### ARCOUNT 
Размер 16 бит.
Целое число без знака, определяющее количество записей в разделе дополнительных записей.

## Question
Раздел запроса. Имеет следующий формат:

                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                     QNAME                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     QTYPE                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     QCLASS                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

### QNAME
Имя домена. 
Представляется в виде последовательности меток, где в каждой метке идёт сначала байт длины, 
а затем следует такое количество байтов. Это поле заканчивается нулевым байтом.

### QTYPE
Размер 2 байта. Определяет тип запроса. В данной реализации используются следующие типы запроса:
- 1 - A,
- 15 - MX,
- 16 - TXT,
- 28 - AAAA.

### QCLASS
Размер 2 байта. Определяет класс запроса. В данной реализации используется класс запроса `IN` (1).

## Answer

Раздел ответа. Имеет следующий формат:

                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                                               /
    /                      NAME                     /
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TYPE                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     CLASS                     |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TTL                      |
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                   RDLENGTH                    |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--|
    /                     RDATA                     /
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

### NAME
Имя домена, записанное в таком же формате, что и QNAME в разделе запроса. Однако могут использоваться ссылки на имя.
Если байт длины начинается с `11`, то тогда младшие 6 бит этого байта стоит воспринимать как первую часть ссылки,
а следующий байт - как вторую часть ссылку. Полученное число - ссылка на байт пакета, откуда следует считать доменное имя.

### TYPE
Аналогичен QTYPE в разделе запроса.

### CLASS
Аналогичен QCLASS в разделе запроса.

### TTL
Размер 32 бита. 
Целое число без знака, указывающее на время (в секундах), в течение которого запись может быть кэширована.

### RDLENGTH
Размер 16 бит.
Целое число без знака, указывающее длину поля RDATA (в байтах).

### RDATA
Имеет переменный размер.
Описывает ресурс.
Формат зависит от TYPE и CLASS.